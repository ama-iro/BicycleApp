<% provide(:title, "#{@post.title}") %>
<% @comments  = @post.feed_comment(@post.id) %>

<div class="container">
  <div class="row post_show_top">
    <div class="col-md-3 offset-md-2 post-show-user">
      <div class="post-show-left">
        <%= gravatar_for @user, size: 80 %>
      </div>
      <div class="post-show-left user-data">
        <p><%= @user.name %></p>
        <p class="post-create-time"><%= time_ago_in_words(@post.created_at) %>前に投稿</p>
        <p class="post-user-edit">
          <% if current_user == @post.user %>
            <%= link_to "編集", edit_post_path(@post) %>　
          <% end %>
          <% if current_user.admin? || current_user.id = @post.user_id %>
            <%= link_to "削除", post_path(@post), method: :delete,
                                     data: { confirm: "本当に削除してよろしいですか？" } %>
          <% end %>
        </p>
      </div>
    </div>
    <div class="post-show-title col-md-3 offset-md-2">
      <div class="post-show-left favorite">
        <%= render 'users/favorite_form' %>
      </div>
      <div class="post-show-left comment">
        <div class="comment-icon">
          <i class="far fa-comment"></i>
        </div>
        <div class="comment-count">
          <b class="comment-count-number"><%= @comment_count %></b> コメント
        </div>
      </div>
    </div>
  </div>
  <div class="row post-show-middle">
    <div class="col-md-3 offset-md-2 post_show_image">
      <div id="carouselIndicators" class="carousel slide show_image_area" data-interval="false" data-ride="carousel">
        <ol class="carousel-indicators">
          <% if @post.images.count == 2 %>
            <li data-target="#carouselIndicators" data-slide-to="0" class="active"></li>
            <li data-target="#carouselIndicators" data-slide-to="1"></li>
          <% elsif @post.images.count == 3 %>
            <li data-target="#carouselIndicators" data-slide-to="0" class="active"></li>
            <li data-target="#carouselIndicators" data-slide-to="1"></li>
            <li data-target="#carouselIndicators" data-slide-to="2"></li>
          <% elsif @post.images.count == 4 %>
            <li data-target="#carouselIndicators" data-slide-to="0" class="active"></li>
            <li data-target="#carouselIndicators" data-slide-to="1"></li>
            <li data-target="#carouselIndicators" data-slide-to="2"></li>
            <li data-target="#carouselIndicators" data-slide-to="3"></li>
          <% elsif @post.images.count == 5 %>
            <li data-target="#carouselIndicators" data-slide-to="0" class="active"></li>
            <li data-target="#carouselIndicators" data-slide-to="1"></li>
            <li data-target="#carouselIndicators" data-slide-to="2"></li>
            <li data-target="#carouselIndicators" data-slide-to="3"></li>
            <li data-target="#carouselIndicators" data-slide-to="4"></li>
          <% end %>
        </ol>
        <div class="carousel-inner">
          <% @post.images.each_with_index do |img, n| %>
            <% if n == 0 %>
              <div class="carousel-item active">
                <%= image_tag img.image_url.to_s %>
              </div>
            <% elsif n >= 1 %>
              <div class="carousel-item">
                <%= image_tag img.image_url.to_s %>
              </div>
            <% end %>
          <% end %>
        </div>


        <a class="carousel-control-prev" href="#carouselIndicators" role="button" data-slide="prev">
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="sr-only">Previous</span>
        </a>
        <a class="carousel-control-next" href="#carouselIndicators" role="button" data-slide="next">
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="sr-only">Next</span>
        </a>
      </div>
    </div>
    <div class="col-md-5 ">
      <ul>
        <li>地域：<%= @post.area %></li>
        <li>具体的な場所：<%= @post.place %></li>
        <li>かかった時間：<%= @post.required_time %>時間</li>
      </ul>
      <div>
        tagaras<%= @post.images.count %>
      </div>
    </div>
  </div>
  <div class="row description-row">
    <div class="col-md-8 offset-md-2 post-show-description">
      <%=safe_join(@post.description.split("\n"),tag(:br))%>
    </div>
  </div>
  <div class="row comment-row">
    <div class="col-md-8 offset-md-2 post-show-coment-area">
      <%= render 'comments/new' %>
      <%= render 'comments/feed_comments' %>
    </div>
  </div>
</div>
